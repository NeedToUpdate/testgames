<html>

<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, user-scalable=no">
    <script language="javascript" src="./lib/two.js"></script>
    <script language="javascript" src="./lib/vector.js"></script>
    <script language="javascript" src="./lib/matrix.js"></script>
    <script language="javascript" src="./lib/drawbase.js"></script>
    <script language="javascript" src="./lib/character.js"></script>
    <script language="javascript" src="./lib/div.js"></script>
    <script language="javascript" src="./lib/rect.js"></script>
    <script language="javascript" src="./lib/eventemitter.js"></script>
    <title>Artem's Testing</title>
    <link rel="stylesheet" href="./wheel.css">
</head>

<body>
<script>

let bw = 100;
let iw = 50
let bp = {x:width/2 - bw/2, y:height/2 -bw/2}
let xx =bp.x + bw/2 - iw/2
let yy = bp.y + bw/2 - iw/2
let pos = {
    on: {x: xx,y:bp.y - iw},
    under: {x: xx,y:bp.y + bw },
    above: {x: xx,y:bp.y - iw*2},
    inside: {x: xx,y:yy, extra:'zIndex 0'},
    behind: {x: xx + bw/2,y:yy, extra:'zIndex 0'},
    beside: {x: bp.x-iw,y:yy},
    front: {x: xx,y:yy, extra:'zIndex 1000'},
    between: {x: xx + iw*2,y:yy},
    below: {x: xx,y:bp.y+bw+iw},

}



let div = new Img('./images/thanos.png',50,50,iw)
let character = new Flyer(50,50,'div');
character.addSprite(div)

let box = new Div(bp.x,bp.y,'darkgreen',bw,bw,true);
box.set("backgroundColor", "brown")
box.rect = new Rect(bp.x,bp.y,bw,bw,true);
document.addEventListener('click', ev=>{
    character.flyto(new Vector(ev.clientX, ev.clientY)).done(x=>{
        jlog(x)
    })
})

Object.keys(pos).forEach((key,i)=>{
    let div = new Div(10+30*i,10,'black',20,20,true)
    div.shape.setAttribute('class','bluebtn')
    let t = document.createTextNode(key.slice(0,2))
    div.shape.appendChild(t)
    div.shape.addEventListener('click',()=>{
        character.flyto(new Vector(pos[key]))
        if(pos[key].extra){
        let inst = pos[key].extra.split(' ')
        character.sprite.set(inst[0],inst[1])
        console.log(character.sprite.shape.style[inst[0]])
        }
    })
})


loop = function(){
    character.update();
    if(Object.keys(character.rect).length>0 && character.rect.contains(box.rect)){
        div.set('border', 'red solid 1px')
    }else{
        div.set('border', 'black solid 1px')
    }
    requestAnimationFrame(loop)
    
};
loop()



</script>

</body>
</html>
<html>

<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, user-scalable=no">
    <script language="javascript" src="./lib/vector.js"></script>
    <script language="javascript" src="./lib/matrix.js"></script>
    <script language="javascript" src="./lib/eventemitter.js"></script>
    <script language="javascript" src="./lib/drawbase.js"></script>
    <script language="javascript" src="./lib/collisioncontainer.js"></script>
    <script language="javascript" src="./lib/PhysicsObject.js"></script>
    <script language="javascript" src="./lib/DomObject.js"></script>
    <script language="javascript" src="./lib/Character.js"></script>
    <script language="javascript" src="./lib/PlayerImages.js"></script>
    <script language="javascript" src="./picture_config.js"></script>
    <title>Artem's Testing</title>
    <link rel="stylesheet" href="global_styles.css">
</head>

<body>
<button class="bluebtn" id="jmpleft">line up</button>
<button class="bluebtn" id="jump">numbers</button>
<script>

    let background = 'background' + getRandom(PICTURE_CONFIG.battle_backgrounds.num) + '.jpg'
    document.body.style.backgroundColor = 'grey';
    document.body.style.backgroundImage = 'url(./images/' + background.toString() + ')';
    document.body.style.backgroundSize = width + 'px auto';
    document.body.style.backgroundRepeat = 'no-repeat';


    let num = 20;
    allnames = shuffle(characters).slice(0, num);
    let chars = allnames.map(name => {
        let char = new Flyer(width/2, 0, name);
        let charimg = new Img('./images/' + char.name + '.png', 0, 0, width/num).fromCenter().onLoad(() => {
            char.addSprite(charimg);
            char.MAX_V = 5;
        });
        return char;
    });

    id('jmpleft').addEventListener('click', () => {
        chars.forEach((char, i) => {
            char.doFlyTo(new Vector(10 + ((width)/num) * i, 200));
        })
    });
    let ps = [];
    let shownumbers = false;
    function postfix(i){
        if(i>3)  return 'th';
        if(i == 3) return 'rd';
        if(i == 2) return 'nd';
        if(i == 1) return 'st';
    }
    id('jump').addEventListener('click', () => {
        shownumbers = !shownumbers;
        if (shownumbers) {
            chars.forEach((char, i) => {
                let p = new P(i + 1 + postfix(i+1), 10 + ((width)/num) * i, 100, '2em').fromCenter();
                p.set('color', 'black');
                p.x = 20 + ((width)/num) * i;
                ps.push(p);
            })
        } else {
            ps.forEach(x => {
                x.remove()
            });
            ps = [];
        }

    });

    loop = function () {
        chars.forEach(char => {
            char.update();
        });
        requestAnimationFrame(loop)
    };
    loop()

</script>
</body>
</html>